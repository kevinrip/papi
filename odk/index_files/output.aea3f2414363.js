$(function(){var CLOSED_NOTI_BAR_IDS_COOKIE='closedNotificationBarIds';var CLICKED_NOTI_BAR_IDS_COOKIE='clickedNotificationBarIds';var notificationBar={init:function(el,url){var $el=$(el);var strIds=Cookies.get(CLOSED_NOTI_BAR_IDS_COOKIE);var strClickedIds=Cookies.get(CLICKED_NOTI_BAR_IDS_COOKIE);notificationBar.$el=$el;if(strIds){notificationBar.closedIds=strIds.split('|');}
if(strClickedIds){notificationBar.clickedIds=strClickedIds.split('|');}
$.get(url).done(function(htmlString){if(!$.trim(htmlString).length>0){return false;}
var $banner=$(htmlString);notificationBar.bannerId=$banner.data('banner-plan-id')+'';notificationBar.landingUrl=$banner.attr('href');dataLayer.push({notiBarLandingUrl:notificationBar.landingUrl});if(!notificationBar.isAlreadyClosed()&&!notificationBar.isAlreadyClicked()){$el.html(htmlString);$('.webapp-base').addClass('open-noti-bar');dataLayer.push({event:'notiBarImpression'});}
var isFirefox=typeof InstallTrigger!=='undefined';if(isFirefox){$(".top-notification-bar").addClass('firefox-top-notification-bar');}});$el.delegate('._click','click',notificationBar.onClick);$el.delegate('._close','click',notificationBar.onClose);},onClose:function(e){var bannerId=notificationBar.bannerId;e.preventDefault();e.stopPropagation();notificationBar.$el.html('');$('.webapp-base').removeClass('open-noti-bar');if(notificationBar.closedIds){notificationBar.closedIds.push(bannerId);bannerId=notificationBar.closedIds.join('|');}
Cookies.set(CLOSED_NOTI_BAR_IDS_COOKIE,bannerId,{expires:1});dataLayer.push({event:'notiBarCloseClick'});},onClick:function(){var bannerId=notificationBar.bannerId;notificationBar.$el.html('');$('.webapp-base').removeClass('open-noti-bar');if(notificationBar.clickedIds){notificationBar.clickedIds.push(bannerId);bannerId=notificationBar.clickedIds.join('|');}
Cookies.set(CLICKED_NOTI_BAR_IDS_COOKIE,bannerId,{expires:365});dataLayer.push({event:'notiBarClick'});},isAlreadyClosed:function(){if(notificationBar.closedIds){return notificationBar.closedIds.indexOf(notificationBar.bannerId)>-1;}
return false;},isAlreadyClicked:function(){if(notificationBar.clickedIds){return notificationBar.clickedIds.indexOf(notificationBar.bannerId)>-1;}
return false;}};function initLimitedFreeWidget(el,url){$(el).load(url,function(){$('.widget.temporary-free').slick({infinite:false,speed:300,slidesToShow:4,slidesToScroll:4,variableWidth:true,prevArrow:$('#widget_limited_free .prev'),nextArrow:$('#widget_limited_free .next')});$('.widget .ellipsis.clamp-one').each(function(){this.style.height='17px';});});}
function initRecommendationWidget(el,url){$(el).load(url,function(){$('.widget.recommendation').slick({infinite:false,speed:300,slidesToShow:4,slidesToScroll:4,variableWidth:true,prevArrow:$('#widget_recommendation .prev'),nextArrow:$('#widget_recommendation .next')});$('.widget .ellipsis.clamp-two').each(function(){this.style.height='35px';});});}
$('.async-widget').each(function(){var id=$(this).attr('id');var url=$(this).data('url');switch(id){case'top_notification_bar':notificationBar.init(this,url);break;case'widget_limited_free':initLimitedFreeWidget(this,url);break;case'widget_recommendation':initRecommendationWidget(this,url);break;}});});;var odkHome=(function(){return{renderEpisodes:function(widget,episodes,selectedLang){var entries=[];var pattern=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");var popular=typeof popular!=="undefined"?popular:false;if(selectedLang==="ko"){selectedLang="kr";}
var carouselTitle=$("."+widget+" h2").text();$.each(episodes,function(episodeIndex,episode){var url=kcpCollectionName.appendKCPCollectionNameParam(episode.url,"Home Rail",carouselTitle);var entry_hot=$("<div/>",{class:"entry"});var subtitleSpan=$("<span/>",{}).css("float","right");var poster=$("<img/>",{class:"ep-poster",src:episode.poster});var anchor=$("<a/>",{href:url,title:episode["title"][selectedLang],class:"bi-newest",});var epTitle=$("<div/>",{class:"ep-title ellipsis clamp-one",text:episode["title"][selectedLang],});if(popular){anchor=$("<a/>",{href:url,title:episode["title"][selectedLang],class:"bi-popular",});epTitle=$("<div/>",{class:"ep-title ellipsis clamp-one",text:episode["title_"+selectedLang],});}
$.each(episode.subtitle,function(subtitleIndex,subtitleValue){var css={"border-top":"none","border-right":"none","border-bottom":"none","border-left":"1px solid #dddddd","padding-left":"3px","padding-bottom":"1px",height:"13px",width:"auto","margin-left":"3px",};if(subtitleIndex===0){css={border:"none","padding-left":"3px","padding-bottom":"1px",height:"13px",width:"auto",};}
var subtitle=$("<img/>",{src:"https://sp.ondemandkorea.com/images/cc_"+subtitleValue+".png",}).css(css);subtitleSpan.append(subtitle);});var epDate=$("<div/>",{class:"ep-date ellipsis clamp-one"});var episodeBadge={};if(widget==="movies"){if(episode.episode_badge_url){episodeBadge=$("<div/>",{class:"ep-badge",});episodeBadge.html('<img src="'+episode.episode_badge_url+'">');}}
if(episode.onAirDate){epDate.append(episode.onAirDate+subtitleSpan[0].outerHTML);}
$(anchor).append(episodeBadge);$(anchor).append(poster);$(anchor).append(epTitle);$(anchor).append(epDate);$(entry_hot).append(anchor);entries.push(entry_hot);});var items=[];for(var i=0;i<entries.length/5;i++){var item=$("<div/>",{class:"item",});items.push(item);}
$.each(entries,function(entryIndex,entry){entry[0].setAttribute("data-index",entryIndex);entry[0].setAttribute("data-category",widget);var matches=entry.children("a").attr("href").match(pattern);var slug=matches[5];entry[0].setAttribute("data-slug",slug);if(entryIndex%5===4){$(entry).addClass("last");}
$(items[Math.floor(entryIndex/5)]).append(entry);});$.each(items,function(itemIndex,item){$("."+widget+" > .slider").append(item);});$(".iosSlider."+widget).iosSlider({snapToChildren:true,desktopClickDrag:true,keyboardControls:true,infiniteSlider:true,navNextSelector:$(".next."+widget),navPrevSelector:$(".prev."+widget),});},};})();;